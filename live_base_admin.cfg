# Base configuration for admin sites.
#
# Do not edit unless you know what you are doing.

[buildout]
extensions=
    mr.developer
parts+=
    org
    org-supervisor-django
    org-nginx
    directories
eggs=
    psycopg2
    one-org
extends =
    versions.cfg
versions = versions
develop = .
unzip = true
auto-checkout = *

[org]
recipe = djangorecipe
project = org
projectegg = org
eggs = ${buildout:eggs}
settings = settings_live_${buildout:site-type}_${buildout:site-name}
control-script = org-live-${buildout:site-type}-${buildout:site-name}
wsgi = true
wsgi-script = org-live-${buildout:site-type}-${buildout:site-name}-wsgi.py
initialization = sys.argv[0] = __file__

[org-supervisor-django]
recipe = collective.recipe.template
input = buildout_templates/supervisor-django.conf.in
output = ${buildout:directory}/supervisor/org-live-${buildout:site-type}-${buildout:site-name}-django.conf
name = org-live-${buildout:site-type}-${buildout:site-name}
control-script = org-live-${buildout:site-type}-${buildout:site-name}
host = 127.0.0.1
num-processes = 1
max-requests = 10000
user = www-data
log = ${buildout:directory}/../log/org-live-${buildout:site-type}-${buildout:site-name}-django.log
error-log = ${buildout:directory}/../log/org-live-${buildout:site-type}-${buildout:site-name}-django-error.log

[org-nginx]
recipe = collective.recipe.template
input = buildout_templates/nginx-admin.conf.in
output = ${buildout:directory}/nginx/org-live-${buildout:site-type}-${buildout:site-name}.conf
server-name = XXX
port = 80
proxy-host = 127.0.0.1
proxy-port = ${buildout:port-prefix}91
media-root = ${buildout:directory}/../org-media-live
static-root = ${buildout:directory}/static
downloads-root = downloads
log = ${buildout:directory}/../log/org-live-${buildout:site-type}-${buildout:site-name}-nginx.log
error-log = ${buildout:directory}/../log/org-live-${buildout:site-type}-${buildout:site-name}-nginx-error.log

[directories]
recipe = z3c.recipe.mkdir
paths =
    ../org-media-live/uploads
    ../org-media-live/downloads
    ../log

[sources]
# Waiting on official djangorecipe for merge
djangorecipe = git git://github.com/hedleyroos/djangorecipe.git
